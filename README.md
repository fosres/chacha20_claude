# ChaCha20 Stream Cipher Implementation

A complete, compilable, and testable implementation of the ChaCha20
stream cipher based on RFC 8439 auto-generated by ClaudeAI. This was
an experiment in AI's ability to auto-generate code that is suitable
for production use.

## Features

- Full ChaCha20 implementation according to RFC 8439
- Multiple test vectors from the official specification
- Automatic test execution with pass/fail reporting
- Clean, readable C code with comprehensive comments
- Cross verification test suite to compare chacha20_cursor.c
versus using Golang's chacha20 package. To test this run the
`run_cross_verify.sh` BASH file using the command:

`bash run_cross_verify.sh`

## Compilation

### Using Make
```bash
cd /home/fosres/Personal/fosres/claude
make
```

### Using GCC directly
```bash
gcc -Wall -Wextra -std=c99 -O2 -o chacha20_test chacha20_cursor.c
```

### Using simple GCC
```bash
gcc chacha20_cursor.c -o chacha20_test
```

## Running

After compilation, run the tests:
```bash
./chacha20_test
```

## Test Vectors

The program includes **7 comprehensive test vectors** from RFC 8439:

### Appendix A.1 - Core Algorithm Tests
1. **Quarter Round Test**: Validates the fundamental quarter-round operation with specific test values
2. **Block Function State Test**: Tests the complete ChaCha20 block function with all-zero inputs

### Section 2.4.2 - ChaCha20 Encryption
3. **Sunscreen Test**: The famous "Ladies and Gentlemen of the class of '99" encryption example

### Appendix A.2 - ChaCha20 Test Vectors
4. **Test Vector #1 (counter=0)**: Keystream generation with all-zero key and nonce, counter at 0
5. **Test Vector #1 (counter=1)**: Keystream generation with all-zero key and nonce, counter at 1
6. **Test Vector #2**: Sunscreen encryption (consistency check with Section 2.4.2)
7. **Test Vector #3 (counter=2)**: Keystream generation with sequential key (00..1f), nonce 0x4a, counter at 2

## Expected Output

When you run the program, it will:
- Display each test vector's parameters (key, nonce, counter)
- Show the plaintext, expected ciphertext, and actual output in hexadecimal
- Print "PASS ✓" or "FAIL ✗" for each test
- Show the ChaCha20 state matrix for the block function test
- Provide a summary of test results

All tests should pass with the message:
```
Test Summary: 7/7 tests passed
```

## Implementation Details

The implementation includes:
- `chacha20_init_state()`: Initializes the ChaCha20 state matrix
- `chacha20_block()`: Performs the 20-round ChaCha20 block function
- `chacha20_encrypt()`: Main encryption/decryption function
- Quarter Round (QR) macro: Core ChaCha20 operation
- Little-endian conversion helpers

## RFC 8439 Reference

This implementation follows RFC 8439:
https://www.rfc-editor.org/rfc/rfc8439.html

ChaCha20 is a stream cipher developed by Daniel J. Bernstein, offering high security and excellent performance on modern CPUs.
